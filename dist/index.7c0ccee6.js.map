{"mappings":"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","sources":["app.js"],"sourcesContent":["\"use strict\";\n\n// getCoordinates()\n// Demande au navigateur de dÃ©tecter la position actuelle de l'utilisateur et retourne une Promise\nconst getCoordinates = () => {\n  return new Promise((res, rej) =>\n    navigator.geolocation.getCurrentPosition(res, rej)\n  );\n};\n\n// getPosition()\n// RÃ©sout la promesse de getCoordinates et retourne un objet {lat: x, long: y}\nconst getPosition = async () => {\n  const position = await getCoordinates();\n  return {\n    lat: position.coords.latitude,\n    long: position.coords.longitude\n  };\n};\n\n// renderWeather(min, max)\n// Affiche la valeu des deux paramÃªtres dans le widget de mÃ©tÃ©o\nconst renderWeather = (min, max) => {\n  document.querySelector(\".min\").textContent = `${min}Â°C`;\n  document.querySelector(\".max\").textContent = `${max}Â°C`;\n  return;\n};\n\n// parseStationData(rawData)\n// ReÃ§oit la rÃ©ponse JSON de l'API Transport/stationboard et recrache un objet\n// ne contenant que les informations pertinentes.\nconst parseStationData = (rawData) => {\n  const { stationboard } = rawData;\n  const departures = stationboard.map((el) => {\n    const date = new Date(el.stop.departure);\n    const hours = date.getHours();\n    const minutes = date.getMinutes();\n    const formattedHours = date.getHours() < 10 ? \"0\" + hours : hours;\n    const formattedMinutes = date.getMinutes() < 10 ? \"0\" + minutes : minutes;\n    return {\n      departure: `${formattedHours}:${formattedMinutes}`,\n      destination: el.to,\n      category: el.category\n    };\n  });\n  return {\n    station: rawData.station.name,\n    departures\n  };\n};\n\n// renderTrain(train)\n// Affiche une ligne de dÃ©part dans le widget CFF.\nconst renderTrain = (train) => {\n  const board = document.querySelector(\".departures\");\n  const html = `\n    <article>\n        <div class=\"time\">${train.departure}</div>\n        <div class=\"category\" data-category=\"${train.category}\">${train.category}</div>\n        <div class=\"destination\">${train.destination}</div>\n    </article>\n    `;\n  board.insertAdjacentHTML(\"beforeend\", html);\n  return;\n};\n\n// renderStationName(station)\n// Affiche le mot passÃ© en paramettre dans le widget CFF. \nconst renderStationName = (station) => {\n  const stationElement = document.querySelector(\".departures header p\");\n  stationElement.textContent = station;\n};\n\n// Votre code peut se trouver dans cette fonction. L'appel vers getPosition est\n// dÃ©jÃ  implÃ©mentÃ©. Si vous jetez un coup d'oeil Ã  votre console vous verrez un objet\n// contenant votre position.\nconst getDashboardInformation = () => {\n  getPosition()\n    .then((res) => {\n      console.log(res);\n      const transportURL = `http://transport.opendata.ch/v1/locations?x=${res.lat}&y=${res.long}&type=station`\n      const weatherURL = `https://api.open-meteo.com/v1/forecast?latitude=${res.lat}&longitude=${res.long}&daily=apparent_temperature_max,apparent_temperature_min&timezone=auto`\n      return Promise.all([\n        fetch(transportURL).then(Response => Response.json()),\n        fetch(weatherURL).then(Response => Response.json())\n      ])\n    })\n    .then((data) => {\n      const [transport, weather] = data;\n\n      console.log(weather);\n      renderWeather(weather.daily.apparent_temperature_min[0], weather.daily.apparent_temperature_max[0]);\n\n\n      console.log(transport);\n      const station = transport.stations.filter((station) => station.icon === \"train\")[0];\n      if (station) {\n        fetch(`https:transport.opendata.ch/v1/stationboard?station=${station}&limit=6`)\n          .then(response => response.json())\n      }\n      else {\n        throw new Error(\"No trains nearby\")\n      }\n    })\n    .then((data) => {\n      const stationData = parseStationData(data);\n      renderStationName(stationData.station);\n      stationData.departures.forEach(element => {\n        renderTrain(element);\n      });\n    })\n    .catch((err) => {\n      console.error(err.message);\n      const station = document.querySelector(\".departures p\")\n      station.textContent = `ðŸ˜¢${err.message}`;\n    })\n};\n\ngetDashboardInformation();\n"],"names":[],"version":3,"file":"index.7c0ccee6.js.map","sourceRoot":"/__parcel_source_root/"}